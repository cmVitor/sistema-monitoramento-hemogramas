O fluxo da aplicação inicia quando laboratórios municipais de regiões como Jataí e Formosa realizam hemogramas em pacientes durante a estação chuvosa. Estes exames são convertidos para o padrão FHIR Observation e enviados para o sistema através de um mecanismo de subscription previamente configurado. O endpoint /fhir/Observation recebe estas mensagens e aciona a função receive_observation que coordena o processamento.

Imediatamente após o recebimento, o FHIRService executa o parsing dos dados através da função parse_observation, que extrai os parâmetros hematológicos essenciais - leucócitos, hemoglobina, plaquetas e hematócrito - além de identificar a região geográfica de origem através do código IBGE embutido nas extensões do recurso FHIR. Cada valor é então submetido à análise individual pela função check_individual_alert que compara com faixas de referência pré-estabelecidas, marcando como anômalo se estiver outside dos limites esperados.

As observações processadas são persistidas no banco de dados através do modelo ObservationDB, que armazena tanto os dados estruturados quanto o recurso FHIR original para auditoria. Paralelamente, uma tarefa em background é acionada para iniciar a análise coletiva na região correspondente. Esta análise é executada pelo AnalysisService que, para cada parâmetro hematológico, calcula estatísticas agregadas usando a função calculate_window_stats, considerando uma janela deslizante de 24 horas.

A detecção de padrões coletivos ocorre através da função detect_collective_pattern que avalia três condições críticas: se a região possui volume mínimo de 30 exames na janela atual, se mais de 40% dos hemogramas apresentam alertas individuais para um determinado parâmetro, e se há um aumento de pelo menos 20% no valor médio comparado com a janela anterior. Quando todas estas condições são satisfeitas, um alerta coletivo é gerado automaticamente.

O AlertService entra em ação criando uma instância de CollectiveAlertDB com todos os detalhes epidemiológicos - região afetada, parâmetro alterado, valores estatísticos, tendência identificada e a lista dos exames que contribuíram para o alerta. Simultaneamente, a função create_fhir_communication gera um recurso FHIR Communication padronizado para interoperabilidade com outros sistemas de saúde, enquanto send_push_notification formata e envia alertas para os dispositivos móveis dos gestores através do Firebase Cloud Messaging.

No aplicativo móvel, os gestores da vigilância epidemiológica recebem notificações push com informações resumidas do surto detectado. Eles podem acessar detalhes completos através da API REST no endpoint /alerts/, utilizando a função get_alerts para filtrar por região, parâmetro ou período. Após análise e tomada de ações, os gestores marcam o alerta como investigado usando mark_alert_investigated, registrando formalmente a resposta no sistema.

Todo o processo é auditável, mantendo o vínculo entre as observations originais e os alertas gerados, permitindo rastreabilidade completa para fins epidemiológicos e de gestão da saúde pública. O sistema continua monitorando continuamente, com análises sendo executadas a cada 15 minutos para detectar novos padrões emergentes, fechando assim o ciclo de vigilância ativa baseada em evidências laboratoriais.