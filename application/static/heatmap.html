<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mapa de Calor - Monitoramento de Hemogramas</title>

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

    <!-- Component Styles -->
    <link rel="stylesheet" href="/static/css/base.css">
    <link rel="stylesheet" href="/static/css/map.css">
    <link rel="stylesheet" href="/static/css/control-panel.css">
    <link rel="stylesheet" href="/static/css/filters.css">
    <link rel="stylesheet" href="/static/css/statistics.css">
    <link rel="stylesheet" href="/static/css/generate-button.css">
    <link rel="stylesheet" href="/static/css/status-message.css">
</head>
<body>
    <!-- Control Panel -->
    <div class="control-panel">
        <!-- Legend Panel -->
        <div class="panel-card">
            <div class="panel-header">
                <span class="panel-title">Legenda</span>
                <button class="toggle-btn" onclick="toggleSection('legend')">−</button>
            </div>
            <div id="legend" class="collapsible-content">
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background: #22c55e;"></div>
                        <span>0 - 5.000 leucócitos (Normal)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #eab308;"></div>
                        <span>5.000 - 10.000 leucócitos (Atenção)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #f97316;"></div>
                        <span>10.000 - 15.000 leucócitos (Alto)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #dc2626;"></div>
                        <span>15.000+ leucócitos (Crítico)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: linear-gradient(135deg, #7c2d12, #4c1d95); border-color: #fbbf24; border-width: 3px;"></div>
                        <span>Região com surto ativo ⚠️</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Filter Panel -->
        <div class="panel-card">
            <div class="panel-header">
                <span class="panel-title">Filtros</span>
                <button class="toggle-btn" onclick="toggleSection('filters')">−</button>
            </div>
            <div id="filters" class="collapsible-content">
                <div class="filter-section">
                    <div class="filter-option active" data-filter="all">
                        <input type="radio" id="filter-all" name="intensity" value="all" checked>
                        <label for="filter-all">Todos os Casos</label>
                    </div>
                    <div class="filter-option" data-filter="outbreak">
                        <input type="radio" id="filter-outbreak" name="intensity" value="outbreak">
                        <label for="filter-outbreak">Apenas Surtos</label>
                        <div class="outbreak-indicator"></div>
                    </div>
                    <div class="filter-option" data-filter="low">
                        <input type="radio" id="filter-low" name="intensity" value="low">
                        <label for="filter-low">Nível Normal</label>
                        <div class="intensity-indicator" style="background: #22c55e;"></div>
                    </div>
                    <div class="filter-option" data-filter="normal">
                        <input type="radio" id="filter-normal" name="intensity" value="normal">
                        <label for="filter-normal">Nível Atenção</label>
                        <div class="intensity-indicator" style="background: #eab308;"></div>
                    </div>
                    <div class="filter-option" data-filter="high">
                        <input type="radio" id="filter-high" name="intensity" value="high">
                        <label for="filter-high">Nível Alto</label>
                        <div class="intensity-indicator" style="background: #f97316;"></div>
                    </div>
                    <div class="filter-option" data-filter="critical">
                        <input type="radio" id="filter-critical" name="intensity" value="critical">
                        <label for="filter-critical">Nível Crítico</label>
                        <div class="intensity-indicator" style="background: #dc2626;"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Statistics Panel -->
        <div class="panel-card">
            <div class="panel-header">
                <span class="panel-title">Estatísticas</span>
                <button class="toggle-btn" onclick="toggleSection('stats')">−</button>
            </div>
            <div id="stats" class="collapsible-content">
                <div class="stats-grid">
                    <div class="stat-item">
                        <span class="stat-value" id="total-cases">0</span>
                        <span class="stat-label">Total de Casos</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="outbreak-count">0</span>
                        <span class="stat-label">Surtos Ativos</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="critical-cases">0</span>
                        <span class="stat-label">Casos Críticos</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="avg-intensity">0</span>
                        <span class="stat-label">Média Leucócitos</span>
                    </div>
                </div>

                <div class="outbreak-alert" id="outbreak-alert" style="display: none;">
                    <span class="outbreak-icon">⚠️</span>
                    <div class="outbreak-text">
                        <strong>Alerta de Surto:</strong> <span id="outbreak-regions">0</span> região(ões) com surto ativo detectado
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Generate Data Button -->
    <div class="generate-panel">
        <button class="generate-btn" id="generateBtn">
            <span class="btn-text">Gerar Dados</span>
            <div class="spinner"></div>
        </button>
    </div>

    <!-- Generate Modal -->
    <div class="generate-modal" id="generateModal">
        <div class="modal-content">
            <h2 class="modal-title">Gerar Hemogramas de Teste</h2>
            <div class="modal-options">
                <div class="modal-option" data-count="500">
                    <div>
                        <div class="modal-option-label">500 Hemogramas</div>
                        <div class="modal-option-desc">Rápido (~2-3 minutos)</div>
                    </div>
                </div>
                <div class="modal-option" data-count="1100">
                    <div>
                        <div class="modal-option-label">1.100 Hemogramas</div>
                        <div class="modal-option-desc">Médio (~5-6 minutos) - Recomendado</div>
                    </div>
                </div>
                <div class="modal-option" data-count="3000">
                    <div>
                        <div class="modal-option-label">3.000 Hemogramas</div>
                        <div class="modal-option-desc">Completo (~15-20 minutos)</div>
                    </div>
                </div>
            </div>
            <button class="modal-close">Cancelar</button>
        </div>
    </div>

    <!-- Status Message -->
    <div class="status-message" id="statusMessage"></div>

    <!-- Map Container -->
    <div id="map"></div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <!-- Application Scripts (ES6 Modules) -->
    <script type="module" src="/static/js/main.js"></script>
</body>
</html>
